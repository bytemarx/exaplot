## Overview
```
         ___________________________________________________________
        |                                                           |
        |   APP                                                     |
        |         +---------------+                                 |
        |         |               |                                 |
        |         |      UI       |                                 |
        |         |               |                                 |
        |         +---------------+                                 |
        |               |   ^                                       |
        |               v   |                                       |
        |         +---------------+          +------------+         |
        |         |               |          |            |         |
        |         |   INTERFACE   |          |   SCRIPT   |         |
        |         |               |          |            |         |
        |         +---------------+          +------------+         |
        |               |   ^                     |  |              |
        |_______________|___|_____________________|  |______________|
                        |   |                    _|  |_
                        |   |                    \    /
         _______________|___|_____________________\  /______________
        |               |   |                      \/               |
        |   CORE        |   |                 +------------+        |
        |               v   |               +------------+ |        |
        |         +---------------+       +------------+ | |        |
        |         |               |       |            | | |        |
        |         |    EXAPLOT    |<------|   SCRIPT   | | |        |
        |         |    MODULE     |------>|   MODULE   | |-+        |
        |         |               |       |            |-+          |
        |         +---------------+       +------------+            |
        |___________________________________________________________|
```


## Core Library
The core library handles (almost) all Python-related activity. Given a script, it loads this script
into the (sub)interpreter's runtime and returns a handle to the script module. The application can
invoke the `run` (or any other) function within the script module through its handle.

Each `exa::Core` object manages a CPython subinterpreter and can load multiple scripts into its
runtime (but the application currently only uses one core with one script at a time).


## Application
The application is further compartmentalized via several management objects: the UI manager,
`AppUI`, the module interface, `Interface`, the data management unit, `DataManager`, and the
supervisor/mediator of these components, `AppMain`.
```
        +---------------+   +---------------+   +---------------+
        |               |   |               |   |               |    ,-------------.
        |   Interface   |<=>|    AppMain    |<=>|     AppUI     |<=>(  UI ELEMENTS  )
        |               |   |               |   |               |    `-------------'
        +---------------+   +---------------+   +---------------+
               /\                  /\
               ||                  ||           +---------------+
               \/                  ||           |               |    ,-------------.
         ,-------------.           ++==========>|  DataManager  |<=>(    STORAGE    )
        (    MODULE     )                       |               |    `-------------'
         `-------------'                        +---------------+
```


### Run Control Flow
The following diagram illustrates the control flow between the application and the interface when a
run is invoked.
```
    APP                                             INTERFACE
(1) emit run                    --------------> (2) get datafile path
                                                    is function?
                                                        YES -> (2a) call datafile function
(3) prompt?                     <--------------     emit datafile init
        YES -> (3a) prompt user
    reset data
    emit datafile init complete --------------> (4) call run function
                                                    error?
                                                        YES -> (4a) emit error info
                                                    emit run completed
```

1. When the application manager receives the UI's run signal, it reconfigures the UI elements for 
the run state (e.g. disables the run button, enables the stop button, etc.) and then emits its run 
signal to the interface.

2. The interface initiates the run by first retrieving the data file path from the script object. 
If the data file path is generated by a runtime function defined within the script, the script 
object calls this function. The interface then emits a data file init signal with the data file 
path and waits for the application manager to initialize the data file.

3. If the data file is configured to prompt the user, the application manager prompts the user for 
any changes to the current data file settings. The application manager submits the data file 
settings to the data manager which resets the datasets and initializes the data file. The 
application manager then signals back to the interface to resume its run slot.

4. The interface invokes the `run` function via the script object. If an error occurred, the error 
information is sent to the application manager to be displayed to the user. The interface then 
signals to the application manager that the run has completed.


### Data Manager Control Flow
```
(EL) = event loop (thread yields execution to event loop)
. = idle state (thread awaiting signal(s))

                   PYTHON                        APP                          DATA
                   THREAD                       THREAD                       THREAD
LOAD ==============================================================================================
                      ,--------------------- AppMain::load                    (EL)
                      |                            |                            .
                      v                            v                            .
            Interface::loadScript                (EL)                           .
                      |                            .                            .
                      v                            .                            .
             Interface::datafile ------------------.                            .
                      |                            |                            .
                      v                            v                            .
                    (EL)               AppMain::module_datafile ----------------.
                      .                            |                            |
                      .                            v                            v
                      .                          (EL)                DataManager::configure
                      .                            .                    (enable/disable)
                      .                            .                            |
                      .                            .                            v
                      .                            .                          (EL)
RUN ===============================================================================================
                      ,--------------------- AppMain::run                       .
                      |                            |                            .
                      v                            v                            .
            Interface::runScript                 (EL)                           .
                      |                            .                            .
                      v                            .                            .
        Interface::initDatafileAndRun -------------.                            .
                      .                            |                            .
                      .                            v                            .
                      .               AppMain::initializeDatafile --------------.
                      .                            .                            |
                      .                            .                            v
                      .                            ,------------------ DataManager::open
                      .                            |                            |
                      .                            v                            v
                      ,-------------- AppMain::initializeDatafile             (EL)
                      |                            |                            .
                      v                            v                            .
        Interface::initDatafileAndRun            (EL)                           .
                      |                            .                            .
                      v                            .                            .
            Interface::runScript ------------------.                            .
                      |                            |                            .
                      v                            v                            .
                    (EL)                 AppMain::runComplete ------------------.
                                                   .                            |
                                                   .                            v
                                                   ,------------------ DataManager::close
                                                   |                            |
                                                   v                            v
                                         AppMain::runComplete                 (EL)
```

Not shown are the (possible) signals emitted from the Python thread to the app thread (and
subsequently to the data thread) during the script's run.
